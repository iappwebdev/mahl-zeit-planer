---
phase: 01-foundation-auth
plan: 03
type: execute
wave: 3
depends_on: ["01-01", "01-02"]
files_modified:
  - src/app/app.component.ts
  - src/app/app.component.html
  - src/app/app.routes.ts
  - src/app/shared/components/layout/layout.component.ts
  - src/app/shared/components/layout/layout.component.html
  - src/app/shared/components/navbar/navbar.component.ts
  - src/app/shared/components/navbar/navbar.component.html
  - src/app/features/dishes/dishes.component.ts
  - src/app/features/dishes/dishes.component.html
  - src/app/features/meal-plan/meal-plan.component.ts
  - src/app/features/meal-plan/meal-plan.component.html
autonomous: false

must_haves:
  truths:
    - "Logged-in user sees navigation with links to Gerichte, Wochenplan, and a visible Logout button"
    - "Clicking Logout signs the user out and redirects to login page"
    - "Navigation shows bottom tabs on mobile and top bar on desktop"
    - "Gerichte page shows a 'Kommt bald' placeholder message"
    - "Wochenplan page shows a 'Kommt bald' placeholder message"
    - "Unauthenticated user is redirected to login page"
    - "All UI text is in German"
  artifacts:
    - path: "src/app/shared/components/layout/layout.component.ts"
      provides: "App shell with responsive navigation wrapper"
      exports: ["LayoutComponent"]
    - path: "src/app/shared/components/navbar/navbar.component.ts"
      provides: "Responsive navigation bar with logout button"
      exports: ["NavbarComponent"]
    - path: "src/app/features/dishes/dishes.component.ts"
      provides: "Placeholder dishes page"
      exports: ["DishesComponent"]
    - path: "src/app/features/meal-plan/meal-plan.component.ts"
      provides: "Placeholder meal plan page"
      exports: ["MealPlanComponent"]
    - path: "src/app/app.routes.ts"
      provides: "Complete route configuration with guards"
      exports: ["routes"]
  key_links:
    - from: "src/app/shared/components/navbar/navbar.component.ts"
      to: "src/app/core/services/supabase.service.ts"
      via: "inject(SupabaseService) for signOut"
      pattern: "supabase.*signOut"
    - from: "src/app/app.routes.ts"
      to: "src/app/core/guards/auth.guard.ts"
      via: "canActivate: [authGuard]"
      pattern: "authGuard"
    - from: "src/app/app.routes.ts"
      to: "src/app/core/guards/guest.guard.ts"
      via: "canActivate: [guestGuard]"
      pattern: "guestGuard"
---

<objective>
Build the responsive app shell with navigation, integrate all routes with guards, create placeholder pages for future features, and configure the complete routing. Then verify the full user flow visually.

Purpose: Users see a complete, navigable German-language app with warm green design. The navigation works on mobile (bottom tabs) and desktop (top bar). Logout is always one click away. Placeholder pages show the full navigation even before features are built.
Output: Working app shell, responsive navbar, placeholder pages, complete route configuration, and verified end-to-end flow.
</objective>

<execution_context>
@C:/Users/simon/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/simon/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-auth/01-RESEARCH.md
@.planning/phases/01-foundation-auth/01-CONTEXT.md
@.planning/phases/01-foundation-auth/01-01-SUMMARY.md
@.planning/phases/01-foundation-auth/01-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create responsive app shell with navigation and placeholder pages</name>
  <files>
    src/app/app.component.ts
    src/app/app.component.html
    src/app/app.routes.ts
    src/app/shared/components/layout/layout.component.ts
    src/app/shared/components/layout/layout.component.html
    src/app/shared/components/navbar/navbar.component.ts
    src/app/shared/components/navbar/navbar.component.html
    src/app/features/dishes/dishes.component.ts
    src/app/features/dishes/dishes.component.html
    src/app/features/meal-plan/meal-plan.component.ts
    src/app/features/meal-plan/meal-plan.component.html
  </files>
  <action>
    **App Shell & Layout:**

    1. Update `src/app/app.component.ts` to be a minimal root component with just `<router-outlet>`. Import `RouterOutlet`. Remove any default Angular generated content (the welcome page template).

    2. Create `src/app/shared/components/layout/layout.component.ts`:
       - Standalone component wrapping the navbar and a `<router-outlet>` for child routes
       - Template structure:
         ```html
         <div class="min-h-screen bg-green-50">
           <app-navbar />
           <main class="pb-20 md:pb-4 pt-4 px-4 max-w-4xl mx-auto">
             <router-outlet />
           </main>
         </div>
         ```
       - `pb-20` on mobile for space below bottom nav; `md:pb-4` on desktop where nav is at top
       - Import NavbarComponent and RouterOutlet

    3. Create `src/app/shared/components/navbar/navbar.component.ts`:
       - Standalone component
       - Inject `SupabaseService` and `Router`
       - `logout()` method: calls `supabaseService.signOut()`, then navigates to `/anmelden`
       - Template implements responsive navigation per locked decision ("Logout direkt sichtbar in Navigationsleiste"):

       **Desktop navigation (hidden on mobile: `hidden md:flex`):**
       - Top bar with green background (`bg-green-700 text-white`)
       - Left side: App name "MahlZeitPlaner" as brand link (links to `/gerichte`)
       - Center/right: navigation links ‚Äî "Meine Gerichte" (links to `/gerichte`), "Wochenplan" (links to `/wochenplan`)
       - Far right: "Abmelden" button (visible! not hidden in menu ‚Äî per locked decision)
       - Active route highlighted with underline or lighter background
       - Rounded corners on nav items, warm feel

       **Mobile navigation (hidden on desktop: `md:hidden`):**
       - Fixed bottom tab bar (`fixed bottom-0 left-0 right-0`)
       - White background with top border and shadow (`bg-white border-t shadow-lg`)
       - Three tabs with icons and labels:
         - Gerichte icon (use a plate/utensils Unicode character like üçΩ or simple SVG) + "Gerichte"
         - Wochenplan icon (calendar Unicode like üìÖ or simple SVG) + "Wochenplan"
         - Abmelden icon (logout/door Unicode like üö™ or simple SVG) + "Abmelden"
       - Active tab: green text (`text-green-700`), inactive: gray text (`text-gray-500`)
       - Large touch targets: minimum 48px height per tab item

       Use `routerLinkActive` directive for active state detection. Import `RouterLink` and `RouterLinkActive`.

    **Placeholder Pages (per locked decision: "Kommt bald" Hinweis):**

    4. Create `src/app/features/dishes/dishes.component.ts`:
       - Standalone component
       - Centered card with warm styling:
         ```html
         <div class="flex flex-col items-center justify-center py-16">
           <div class="bg-white rounded-2xl shadow-md p-8 text-center max-w-sm">
             <div class="text-5xl mb-4">üçΩÔ∏è</div>
             <h2 class="text-xl font-semibold text-green-800 mb-2">Meine Gerichte</h2>
             <p class="text-gray-600">Kommt bald! Hier kannst du bald deine Lieblingsgerichte verwalten.</p>
           </div>
         </div>
         ```

    5. Create `src/app/features/meal-plan/meal-plan.component.ts`:
       - Standalone component
       - Same card layout:
         ```html
         <div class="flex flex-col items-center justify-center py-16">
           <div class="bg-white rounded-2xl shadow-md p-8 text-center max-w-sm">
             <div class="text-5xl mb-4">üìÖ</div>
             <h2 class="text-xl font-semibold text-green-800 mb-2">Wochenplan</h2>
             <p class="text-gray-600">Kommt bald! Hier wird bald dein Wochenplan erscheinen.</p>
           </div>
         </div>
         ```

    **Complete Route Configuration:**

    6. Update `src/app/app.routes.ts` with the full route tree:
       ```typescript
       export const routes: Routes = [
         // Auth routes (guest guard ‚Äî redirect logged-in users away)
         {
           path: 'anmelden',
           loadComponent: () => import('./features/auth/login/login.component').then(m => m.LoginComponent),
           canActivate: [guestGuard]
         },
         {
           path: 'registrieren',
           loadComponent: () => import('./features/auth/register/register.component').then(m => m.RegisterComponent),
           canActivate: [guestGuard]
         },
         {
           path: 'email-bestaetigen',
           loadComponent: () => import('./features/auth/confirm-email/confirm-email.component').then(m => m.ConfirmEmailComponent)
         },
         {
           path: 'passwort-vergessen',
           loadComponent: () => import('./features/auth/reset-password/reset-password.component').then(m => m.ResetPasswordComponent),
           canActivate: [guestGuard]
         },
         // Protected routes (auth guard ‚Äî require login)
         {
           path: '',
           component: LayoutComponent,
           canActivate: [authGuard],
           children: [
             { path: 'gerichte', component: DishesComponent },
             { path: 'wochenplan', component: MealPlanComponent },
             { path: '', redirectTo: 'gerichte', pathMatch: 'full' }
           ]
         },
         // Fallback
         { path: '**', redirectTo: 'anmelden' }
       ];
       ```

       Key design decisions:
       - German route names (`anmelden`, `registrieren`, etc.) for German-only app
       - Auth pages use `loadComponent` for lazy loading (no layout wrapper needed)
       - Protected routes wrapped in `LayoutComponent` parent so navbar shows only when logged in
       - Default redirect `/` goes to `/gerichte` (per research: "Meine Gerichte" as landing page)
       - Auth pages have `guestGuard` to redirect already-logged-in users
       - Protected pages have `authGuard` on the layout parent (children inherit)
       - `email-bestaetigen` has no guard ‚Äî accessible always (user just registered, not yet authenticated)

    **Use Angular 19 control flow syntax** (`@if`, `@for`) not `*ngIf`/`*ngFor`.
  </action>
  <verify>
    Run `ng serve` ‚Äî app starts without errors.
    Run `ng build` ‚Äî production build succeeds.
    Navigate to localhost:4200 ‚Äî redirects to /anmelden (not logged in).
    Check navbar component exists with both mobile and desktop templates.
    Check DishesComponent and MealPlanComponent show "Kommt bald" text.
    Check app.routes.ts imports authGuard and guestGuard.
    Check layout component wraps navbar + router-outlet.
  </verify>
  <done>
    Responsive app shell with top navbar on desktop and bottom tabs on mobile. Logout button visible in navigation (not hidden in submenu). Two placeholder pages (Gerichte, Wochenplan) with "Kommt bald" message. Complete route configuration with German routes, auth guard on protected pages, guest guard on auth pages. Default landing page is /gerichte after login.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify complete auth flow and responsive design</name>
  <files>no files modified ‚Äî verification only</files>
  <action>
    Human verifies the complete Phase 1 implementation end-to-end.

    What was built:
    - Registration with email confirmation prompt
    - Login with inline validation errors
    - Password reset flow
    - Responsive navigation (bottom tabs on mobile, top bar on desktop)
    - Placeholder pages for Gerichte and Wochenplan
    - Route guards (auth and guest)
    - German-language UI throughout
    - Warm green Tailwind design with rounded corners

    Prerequisites: Configure Supabase credentials in `src/environments/environment.ts` and run the SQL migration in Supabase SQL Editor.

    Verification steps:
    1. Start dev server: `ng serve` ‚Äî opens on http://localhost:4200
    2. Unauthenticated redirect: Visiting / should redirect to /anmelden
    3. Register flow:
       a. Click "Noch kein Konto? Registrieren" link
       b. Try submitting empty form ‚Äî see red inline errors below each field
       c. Fill in name, valid email, password (8+ chars) and submit
       d. Should redirect to /email-bestaetigen with confirmation message
    4. Login flow:
       a. Go to /anmelden
       b. Try invalid credentials ‚Äî see error message
       c. After confirming email in inbox, log in with valid credentials
       d. Should redirect to /gerichte
    5. Authenticated app:
       a. See navigation bar with "Meine Gerichte", "Wochenplan", and "Abmelden"
       b. Navigate to "Wochenplan" ‚Äî see "Kommt bald" placeholder
       c. Navigate back to "Meine Gerichte" ‚Äî see "Kommt bald" placeholder
    6. Logout:
       a. Click "Abmelden" in navigation
       b. Should redirect to /anmelden
       c. Visiting /gerichte should redirect back to /anmelden
    7. Responsive design:
       a. Desktop: top navigation bar with green background
       b. Resize to mobile width: bottom tab navigation appears
       c. Auth pages use full screen with large inputs
    8. Password reset:
       a. On login page, click "Passwort vergessen?"
       b. Enter email and submit ‚Äî see confirmation message
    9. Visual check:
       a. Overall feel: warm, friendly, green tones
       b. Rounded corners on cards and buttons
       c. All text in German

    Resume signal: Type "approved" or describe any issues to fix.
  </action>
  <verify>Human confirms all 9 verification steps pass by typing "approved"</verify>
  <done>Complete Phase 1 auth flow and responsive app shell verified by human ‚Äî register, login, logout, password reset, navigation, placeholders, and German UI all working correctly</done>
</task>

</tasks>

<verification>
1. Full registration flow works: form -> submit -> confirm email page
2. Full login flow works: form -> submit -> redirect to /gerichte
3. Logout works: click -> redirect to /anmelden
4. Route guards work: unauthenticated users to /anmelden, authenticated users skip auth pages
5. Navigation responsive: bottom tabs mobile, top bar desktop
6. Logout button visible in navigation (not in submenu)
7. Placeholder pages show "Kommt bald" for Gerichte and Wochenplan
8. All text in German
9. Warm green design with rounded corners
10. Inline validation errors in red below fields
</verification>

<success_criteria>
- User can register, see email confirmation prompt, log in after confirming, and log out
- Navigation works on mobile (bottom tabs) and desktop (top bar)
- Logout is one click from any authenticated page
- Placeholder pages communicate "Kommt bald" for future features
- Route guards correctly protect/redirect
- All UI is in German with warm green Tailwind styling
- Human has verified the complete flow works end-to-end
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-auth/01-03-SUMMARY.md`
</output>
